"use strict";(self.webpackChunkbp_docs=self.webpackChunkbp_docs||[]).push([[976],{7879:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"intro","title":"Tutorial Intro","description":"Table of Contents","source":"@site/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/bookpub/docs/intro","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","next":{"title":"bookpub - Extras","permalink":"/bookpub/docs/category/bookpub---extras"}}');var t=s(4848),r=s(8453);const o={sidebar_position:1},l="Tutorial Intro",a={},c=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Pre-Requisites",id:"pre-requisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Using Pipelines or Stages",id:"using-pipelines-or-stages",level:2},{value:"Default Pipelines &amp; Stages (<code>book.config.yml</code>)",id:"default-pipelines--stages-bookconfigyml",level:3},{value:"Defining Custom Pipelines in <code>book.config.yml</code>",id:"defining-custom-pipelines-in-bookconfigyml",level:3},{value:"Working With Meta",id:"working-with-meta",level:2},{value:"Overriding or Adding Stages",id:"overriding-or-adding-stages",level:2},{value:"Overriding a Pre-Built Stage",id:"overriding-a-pre-built-stage",level:3},{value:"Creating a New Stage",id:"creating-a-new-stage",level:3},{value:"Developing Custom Stages",id:"developing-custom-stages",level:3},{value:"Build Outputs",id:"build-outputs",level:2}];function d(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"tutorial-intro",children:"Tutorial Intro"})}),"\n",(0,t.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#installation",children:"Installation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#quick-start",children:"Quick Start"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#project-structure",children:"Project Structure"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#using-pipelines-or-stages",children:"Using Pipelines or Stages"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#working-with-meta",children:"Working With Meta"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#build-outputs",children:"Build Outputs"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#pandoc-markdown-tutorial",children:"Pandoc Markdown Tutorial"})}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"pre-requisites",children:"Pre-Requisites"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Installing Pandoc"})}),"\n",(0,t.jsx)(n.p,{children:"bookpub uses pandoc in its built-in markdown stage"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["(You can easily use something else by visiting the ",(0,t.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})," section)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Please visit the ",(0,t.jsx)(n.a,{href:"https://pandoc.org/installing.html",children:"Pandoc Installation Page"})," for directions on installing Pandoc on your operating system"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Installing PrinceXML"})}),"\n",(0,t.jsx)(n.p,{children:"bookpub uses princexml (an advanced PDF typesetting library) in its built-in pdf stage"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["(You can easily use something else, by visiting the ",(0,t.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})," section)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Please visit the ",(0,t.jsx)(n.a,{href:"https://www.princexml.com/doc/12/doc-install/",children:"PrinceXML Installation Page"})," for directions on installing Pandoc on your operating system"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install -g bookpub\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:["Create a new ",(0,t.jsx)(n.code,{children:"bookpub"})," project"]}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"bookpub new my-book\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This scaffolds a folder ",(0,t.jsx)(n.code,{children:"my-book/"})," with all the necessary boilerplate code/files."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Build an HTML format of your book"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd my-book\nbookpub build html\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The output is in ",(0,t.jsx)(n.code,{children:"build/html/"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Open"})," ",(0,t.jsx)(n.code,{children:"manuscript/index.md.ejs"})," to write your content, or ",(0,t.jsx)(n.strong,{children:"customize"})," ",(0,t.jsx)(n.code,{children:"book.config.yml"})," with your book\u2019s metadata and pipelines/stages."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,t.jsxs)(n.p,{children:["When you create a new Bookpub project (e.g. ",(0,t.jsx)(n.code,{children:"my-book/"}),"), you\u2019ll typically see:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"my-book/\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 book.config.yml\n\u251c\u2500\u2500 manuscript/\n\u2502   \u251c\u2500\u2500 index.md.ejs\n\u2502   \u2514\u2500\u2500 themes/\n|       \u2514\u2500\u2500 default/\n\u2502           \u251c\u2500\u2500 css/\n\u2502           \u2502   \u251c\u2500\u2500 styles.pdf.scss\n\u2502           \u2502   \u2514\u2500\u2500 styles.epub.scss\n\u2502           \u251c\u2500\u2500 images/\n\u2502           \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 stages/\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"book.config.yml"})}),": Central config for metadata, pipeline definitions, etc."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"manuscript/"})}),": The source files for your book.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"index.md.ejs"})," is your main entry point, combining EJS + Markdown."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"themes/"})," holds SCSS/CSS, images, fonts, etc."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"stages/"})}),": (Optional) Put custom stages or override existing ones here."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"package.json"})}),": The project\u2019s local dependencies (including ",(0,t.jsx)(n.code,{children:"bookpub"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"using-pipelines-or-stages",children:"Using Pipelines or Stages"}),"\n",(0,t.jsxs)(n.h3,{id:"default-pipelines--stages-bookconfigyml",children:["Default Pipelines & Stages (",(0,t.jsx)(n.code,{children:"book.config.yml"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["Bookpub comes with a couple pipelines pre-defined for ",(0,t.jsx)(n.code,{children:"html"})," and ",(0,t.jsx)(n.code,{children:"pdf"})," that have pre-built stages (",(0,t.jsx)(n.em,{children:"all of which you can override"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"buildPipelines:\n  html:\n    stages:\n      - name: ejs\n      - name: markdown\n      - name: themes\n      - name: writeHtml\n\n  pdf:\n    stages:\n      - name: ejs\n      - name: markdown\n      - name: themes\n      - name: writeHtml\n      - name: pdf\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now ",(0,t.jsx)(n.code,{children:"bookpub build pdf"})," will run the pdf build-pipeline and execute these stages in order: ",(0,t.jsx)(n.code,{children:"ejs > markdown > themes > writeHtml > pdf "}),"."]}),"\n",(0,t.jsxs)(n.h3,{id:"defining-custom-pipelines-in-bookconfigyml",children:["Defining Custom Pipelines in ",(0,t.jsx)(n.code,{children:"book.config.yml"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# book.config.yml\n\nglobal: # Applied globally to all pipelines\n  meta:\n    title: "My Book"\n    author: "Famous Name"\n  stages:\n    - name: ejs # Applied to all ejs stages in every pipeline\n      config:\n        rmWhitespace: true\n\nbuildPipelines:\n  pdf-lg: # A custom pipeline for a large font pdf\n    meta:\n      title: "My Book (Large Print)" # Overrides global meta\n      fontSize: 18\n    stages:\n      - name: ejs\n        config: # Overrides global settings for thie pipeline\n          rmWhitespace: false\n      - name: markdown\n      - name: theme\n      - name: writeHtml\n      - name: pdf\n        config:\n          lineSpacing: 1.5\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Now ",(0,t.jsx)(n.code,{children:"bookpub build pdf-lg"})," will run the pdf-lg build-pipeline and execute these stages in order: ",(0,t.jsx)(n.code,{children:"ejs > markdown > themes > writeHtml > pdf "}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"working-with-meta",children:"Working With Meta"}),"\n",(0,t.jsxs)(n.p,{children:["Your ",(0,t.jsx)(n.code,{children:"file.md.ejs"})," can reference metadata from ",(0,t.jsx)(n.code,{children:"book.config.yml"})," like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-markdown",children:"# <%= meta.title %>\n\nAuthor: <%= meta.author %>\n\nThis is dynamic EJS. If you specify `meta.title` in `book.config.yml`,\nit appears here at build time.\n"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"global"})," ",(0,t.jsx)(n.code,{children:"meta"})," applie to ",(0,t.jsx)(n.strong,{children:"all"})," builds."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pipeline-specific"})," ",(0,t.jsx)(n.code,{children:"meta"})," (defined under a pipeline) override global values for that build only."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"overriding-or-adding-stages",children:"Overriding or Adding Stages"}),"\n",(0,t.jsx)(n.h3,{id:"overriding-a-pre-built-stage",children:"Overriding a Pre-Built Stage"}),"\n",(0,t.jsxs)(n.p,{children:["If you want to modify bookpub's pre-built ",(0,t.jsx)(n.strong,{children:"ejs"})," stage (for example), just create a matching folder in your project:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"my-book/\n\u2514\u2500 stages/\n   \u2514\u2500 ejs/\n      \u2514\u2500 index.js\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Inside ",(0,t.jsx)(n.code,{children:"index.js"}),", export a ",(0,t.jsx)(n.code,{children:"run()"})," function:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// my-book/stages/ejs/index.js\nexport async function run(manuscript, { stageConfig, globalConfig }) {\n  // Your custom logic\n  // e.g., call the built-in ejs stage, then do extra stuff\n  // or replace it entirely\n  return manuscript;\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Bookpub automatically detects ",(0,t.jsx)(n.code,{children:"stages/ejs/index.js"})," and uses it ",(0,t.jsx)(n.strong,{children:"instead"})," of the pre-built EJS stage."]}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-new-stage",children:"Creating a New Stage"}),"\n",(0,t.jsxs)(n.p,{children:["Just name a folder in ",(0,t.jsx)(n.code,{children:"stages/"})," (e.g., ",(0,t.jsx)(n.code,{children:"stages/compressImages/"}),") with an ",(0,t.jsx)(n.code,{children:"index.js"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'// my-book/stages/compressImages/index.js\nexport async function run(manuscript, { stageConfig, globalConfig }) {\n  console.log("Compressing images...");\n  // do your stuff\n  return manuscript;\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Then add it to a pipeline in ",(0,t.jsx)(n.code,{children:"book.config.yml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"buildPipelines:\n  pdf:\n    stages:\n      - name: ejs\n      - name: compressImages\n      - name: markdown\n      - name: theme\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"developing-custom-stages",children:"Developing Custom Stages"}),"\n",(0,t.jsxs)(n.p,{children:["Bookpub's modular design allows you to extend or replace any stage by creating a new module. Each stage is expected to expose a single asynchronous function named ",(0,t.jsx)(n.code,{children:"run()"}),". When Bookpub executes a build pipeline, it will call the ",(0,t.jsx)(n.code,{children:"run()"})," function for each stage, passing in three key parameters:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"run()"})," Function"]}),(0,t.jsx)(n.br,{}),"\n","This is the entry point for your stage. It must be an asynchronous function (or return a Promise) so that the build pipeline can wait for it to complete its work before proceeding to the next stage. For example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"export async function run(manuscript, { stageConfig, globalConfig }) {\n  // Your custom stage logic here\n  return manuscript;\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"manuscript"})," Object"]}),(0,t.jsx)(n.br,{}),"\n","This object represents the current state of the manuscript and is passed from one stage to the next. It typically contains:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"manuscript.content"}),": The manuscript content (e.g., rendered Markdown or HTML). Each stage can read or modify this property."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"manuscript.buildType"}),": The current build type (e.g., ",(0,t.jsx)(n.code,{children:"'html'"}),", ",(0,t.jsx)(n.code,{children:"'pdf'"}),", etc.), which might affect how the stage processes the content."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Your stage should update and then return the modified ",(0,t.jsx)(n.code,{children:"manuscript"})," so that subsequent stages can work with the latest version."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"stageConfig"})," Object"]}),(0,t.jsx)(n.br,{}),"\n","This object contains configuration options specific to the current stage. It is built by merging any global defaults (from ",(0,t.jsx)(n.code,{children:"global.stages"})," in ",(0,t.jsx)(n.code,{children:"book.config.yml"}),") with pipeline-specific overrides. It is typically structured as follows:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"{\n  config: {\n    // Stage-specific configuration options go here.\n    // For example, for the built-in EJS stage:\n    rmWhitespace: true\n  },\n  meta: {\n    // Optional stage-specific metadata.\n  }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"stageConfig.config"})," to access options for your stage. For example, if you\u2019re building a custom image compressor, you might include options such as ",(0,t.jsx)(n.code,{children:"quality"})," or ",(0,t.jsx)(n.code,{children:"maxWidth"})," in this object."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"globalConfig"})," Object"]}),(0,t.jsx)(n.br,{}),"\n","This object contains configuration and metadata that apply to every stage. Typically, it includes:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'{\n  meta: {\n    // Global metadata such as title, author, publication date, etc.\n    title: "My Awesome Book",\n    author: "John Doe",\n    ...\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This allows your stage to access universal information about the book, regardless of its own specific configuration."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["By following this API, you ensure that your custom stage can be seamlessly integrated into Bookpub's build pipeline. Developers can add new functionality or override existing stages simply by creating a folder under ",(0,t.jsx)(n.code,{children:"/stages/"})," with the same name as the stage they want to replace. Bookpub will automatically use your custom implementation."]}),"\n",(0,t.jsx)(n.h2,{id:"build-outputs",children:"Build Outputs"}),"\n",(0,t.jsx)(n.p,{children:"By default, Bookpub outputs to:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"build/<buildType>/\n"})}),"\n",(0,t.jsx)(n.p,{children:"For example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"build/html/\nbuild/pdf/\nbuild/pdf-lg/\n"})}),"\n",(0,t.jsx)(n.p,{children:"That folder might include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"index.html"})," (or whatever each stage produces)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"themes/"})," (copied or compiled assets)"]}),"\n",(0,t.jsx)(n.li,{children:"Final PDF, EPUB, or other output generated by custom stages"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);