"use strict";(self.webpackChunkbp_docs=self.webpackChunkbp_docs||[]).push([[134],{1943:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"type":"mdx","permalink":"/bookpub/markdown-page","source":"@site/src/pages/markdown-page.md","title":"bookpub - Book Publishing Framework","description":"A lightweight book publishing cli framework providing customizable pipelines with modular stages that can be stacked like legos to create any type/number of publishable assets you need---from only one manuscript source.","frontMatter":{"title":"bookpub - Book Publishing Framework"},"unlisted":false}');var l=i(4848),r=i(8453);const t={title:"bookpub - Book Publishing Framework"},a="bookpub",o={},d=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Features",id:"features",level:2},{value:"Pre-Requisites",id:"pre-requisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Using Pipelines or Stages",id:"using-pipelines-or-stages",level:2},{value:"Default Pipelines &amp; Stages (<code>book.config.yml</code>)",id:"default-pipelines--stages-bookconfigyml",level:3},{value:"Defining Custom Pipelines in <code>book.config.yml</code>",id:"defining-custom-pipelines-in-bookconfigyml",level:3},{value:"Working With Meta",id:"working-with-meta",level:2},{value:"Overriding or Adding Stages",id:"overriding-or-adding-stages",level:2},{value:"Overriding a Pre-Built Stage",id:"overriding-a-pre-built-stage",level:3},{value:"Creating a New Stage",id:"creating-a-new-stage",level:3},{value:"Developing Custom Stages",id:"developing-custom-stages",level:3},{value:"Build Outputs",id:"build-outputs",level:2},{value:"Pandoc Markdown Tutorial",id:"pandoc-markdown-tutorial",level:2},{value:"1. General Markdown",id:"1-general-markdown",level:3},{value:"3. Link Attributes",id:"3-link-attributes",level:3},{value:"4. Bracketed Spans",id:"4-bracketed-spans",level:3},{value:"5. Generic Attributes",id:"5-generic-attributes",level:3},{value:"6. Raw Attributes",id:"6-raw-attributes",level:3},{value:"7. Designating Specific HTML Tags",id:"7-designating-specific-html-tags",level:3},{value:"Section",id:"section",level:4},{value:"Article",id:"article",level:4},{value:"Footer",id:"footer",level:4},{value:"Div",id:"div",level:4},{value:"Span",id:"span",level:4},{value:"Pre and Code",id:"pre-and-code",level:4},{value:"Line Break (br)",id:"line-break-br",level:4},{value:"Horizontal Rule (hr)",id:"horizontal-rule-hr",level:4}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"bookpub",children:"bookpub"})}),"\n",(0,l.jsx)(n.p,{children:"A lightweight book publishing cli framework providing customizable pipelines with modular stages that can be stacked like legos to create any type/number of publishable assets you need---from only one manuscript source."}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Author's Note:"}),"\n",(0,l.jsxs)(n.p,{children:["My intent is to focus ",(0,l.jsx)(n.strong,{children:"bookpub"})," on orchestrating pipelines and stages in a standardized way so that users can easily add their own solutions (stages) for converting the manuscript."]}),"\n",(0,l.jsx)(n.p,{children:"Currently bookpub's pre-built stages utilize standard Web conventions for styling (HTML/CSS/JS)."}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#features",children:"Features"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#installation",children:"Installation"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#quick-start",children:"Quick Start"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#project-structure",children:"Project Structure"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#using-pipelines-or-stages",children:"Using Pipelines or Stages"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#working-with-meta",children:"Working With Meta"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#build-outputs",children:"Build Outputs"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#pandoc-markdown-tutorial",children:"Pandoc Markdown Tutorial"})}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"One Manuscript Source"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["The manuscript is written in industry-standard ",(0,l.jsx)(n.a,{href:"https://www.markdownguide.org/",children:"Markdown"}),", wrapped in ",(0,l.jsx)(n.a,{href:"https://ejs.co/",children:"EJS (Embedded JavaScript: a javascript based templating standard)"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Stage-Based Pipelines"}),": Pipelines are composed of individual stages executed in sequence.","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Pre-Defined Build Pipelines:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"HTML"})," - Creates an HTML build of your book."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PDF"})," - Creates a PDF build of your book."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Pre-Built Stages:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ejs"})," (EJS to Markdown)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"markdown"})," (Markdown to HTML using Pandoc)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"themes"})," (SCSS to CSS using SASS and coping assets)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"pdf"})," (html/css/js to PDF using PrinceXML)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Extend or Override"}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Drop in your own custom ",(0,l.jsx)(n.strong,{children:"stages"})]}),"\n",(0,l.jsx)(n.li,{children:"Define new build pipelines and their stages."}),"\n",(0,l.jsx)(n.li,{children:"Or Override built-in stages and/or pipelines."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Dev Mode"}),": View the final pipeline result in real time (via browser) as you edit the manuscript."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Project Settings (book.config.yml)"}),": Use ",(0,l.jsx)(n.a,{href:"https://spacelift.io/blog/yaml",children:"YAML"})," to define global, pipeline, or stage based settings","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Meta"})," (e.g. title: My Title)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Config"})," (e.g. (for EJS... rmWhitespace: true))"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Scaffolding"}),": Spin up a new bookpub project with a single command that includes all the boilerplate."]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"pre-requisites",children:"Pre-Requisites"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Installing Pandoc"})}),"\n",(0,l.jsx)(n.p,{children:"bookpub uses pandoc in its built-in markdown stage"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["(You can easily use something else by visiting the ",(0,l.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})," section)"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Please visit the ",(0,l.jsx)(n.a,{href:"https://pandoc.org/installing.html",children:"Pandoc Installation Page"})," for directions on installing Pandoc on your operating system"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Installing PrinceXML"})}),"\n",(0,l.jsx)(n.p,{children:"bookpub uses princexml (an advanced PDF typesetting library) in its built-in pdf stage"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["(You can easily use something else, by visiting the ",(0,l.jsx)(n.a,{href:"#overriding-or-adding-stages",children:"Overriding or Adding Stages"})," section)"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Please visit the ",(0,l.jsx)(n.a,{href:"https://www.princexml.com/doc/12/doc-install/",children:"PrinceXML Installation Page"})," for directions on installing Pandoc on your operating system"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Option 1: Install globally\nnpm install -g bookpub\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Create a new Bookpub project"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"bookpub new my-book\n"})}),"\n",(0,l.jsxs)(n.p,{children:["This scaffolds a folder ",(0,l.jsx)(n.code,{children:"my-book/"})," with all necessary boilerplate."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Build a PDF"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd my-book\nbookpub build html\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The output is in ",(0,l.jsx)(n.code,{children:"build/html/"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Open"})," ",(0,l.jsx)(n.code,{children:"manuscript/index.md.ejs"})," to write your content, or ",(0,l.jsx)(n.strong,{children:"customize"})," ",(0,l.jsx)(n.code,{children:"book.config.yml"})," with your book\u2019s metadata and pipelines/stages."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,l.jsxs)(n.p,{children:["When you create a new Bookpub project (e.g. ",(0,l.jsx)(n.code,{children:"my-book/"}),"), you\u2019ll typically see:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"my-book/\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 book.config.yml\n\u251c\u2500\u2500 manuscript/\n\u2502   \u251c\u2500\u2500 index.md.ejs\n\u2502   \u2514\u2500\u2500 themes/\n|       \u2514\u2500\u2500 default/\n\u2502           \u251c\u2500\u2500 css/\n\u2502           \u2502   \u251c\u2500\u2500 styles.pdf.scss\n\u2502           \u2502   \u2514\u2500\u2500 styles.epub.scss\n\u2502           \u251c\u2500\u2500 images/\n\u2502           \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 stages/\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"book.config.yml"})}),": Central config for metadata, pipeline definitions, etc."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"manuscript/"})}),": The source files for your book.","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"index.md.ejs"})," is your main entry point, combining EJS + Markdown."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"themes/"})," holds SCSS/CSS, images, fonts, etc."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"stages/"})}),": (Optional) Put custom stages or override existing ones here."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"package.json"})}),": The project\u2019s local dependencies (including ",(0,l.jsx)(n.code,{children:"bookpub"}),")."]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"using-pipelines-or-stages",children:"Using Pipelines or Stages"}),"\n",(0,l.jsxs)(n.h3,{id:"default-pipelines--stages-bookconfigyml",children:["Default Pipelines & Stages (",(0,l.jsx)(n.code,{children:"book.config.yml"}),")"]}),"\n",(0,l.jsxs)(n.p,{children:["Bookpub comes with a couple pipelines pre-defined for ",(0,l.jsx)(n.code,{children:"html"})," and ",(0,l.jsx)(n.code,{children:"pdf"})," that have pre-built stages (",(0,l.jsx)(n.em,{children:"all of which you can override"}),"):"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"buildPipelines:\n  html:\n    stages:\n      - name: ejs\n      - name: markdown\n      - name: themes\n      - name: writeHtml\n\n  pdf:\n    stages:\n      - name: ejs\n      - name: markdown\n      - name: themes\n      - name: writeHtml\n      - name: pdf\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Now ",(0,l.jsx)(n.code,{children:"bookpub build pdf"})," will run the pdf build-pipeline and execute these stages in order: ",(0,l.jsx)(n.code,{children:"ejs > markdown > themes > writeHtml > pdf "}),"."]}),"\n",(0,l.jsxs)(n.h3,{id:"defining-custom-pipelines-in-bookconfigyml",children:["Defining Custom Pipelines in ",(0,l.jsx)(n.code,{children:"book.config.yml"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# book.config.yml\n\nglobal: # Applied globally to all pipelines\n  meta:\n    title: "My Book"\n    author: "Famous Name"\n  stages:\n    - name: ejs # Applied to all ejs stages in every pipeline\n      config:\n        rmWhitespace: true\n\nbuildPipelines:\n  pdf-lg: # A custom pipeline for a large font pdf\n    meta:\n      title: "My Book (Large Print)" # Overrides global meta\n      fontSize: 18\n    stages:\n      - name: ejs\n        config: # Overrides global settings for thie pipeline\n          rmWhitespace: false\n      - name: markdown\n      - name: theme\n      - name: writeHtml\n      - name: pdf\n        config:\n          lineSpacing: 1.5\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Now ",(0,l.jsx)(n.code,{children:"bookpub build pdf-lg"})," will run the pdf-lg build-pipeline and execute these stages in order: ",(0,l.jsx)(n.code,{children:"ejs > markdown > themes > writeHtml > pdf "}),"."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"working-with-meta",children:"Working With Meta"}),"\n",(0,l.jsxs)(n.p,{children:["Your ",(0,l.jsx)(n.code,{children:"file.md.ejs"})," can reference metadata from ",(0,l.jsx)(n.code,{children:"book.config.yml"})," like this:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"# <%= meta.title %>\n\nAuthor: <%= meta.author %>\n\nThis is dynamic EJS. If you specify `meta.title` in `book.config.yml`,\nit appears here at build time.\n"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"global"})," ",(0,l.jsx)(n.code,{children:"meta"})," applie to ",(0,l.jsx)(n.strong,{children:"all"})," builds."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Pipeline-specific"})," ",(0,l.jsx)(n.code,{children:"meta"})," (defined under a pipeline) override global values for that build only."]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"overriding-or-adding-stages",children:"Overriding or Adding Stages"}),"\n",(0,l.jsx)(n.h3,{id:"overriding-a-pre-built-stage",children:"Overriding a Pre-Built Stage"}),"\n",(0,l.jsxs)(n.p,{children:["If you want to modify bookpub's pre-built ",(0,l.jsx)(n.strong,{children:"ejs"})," stage (for example), just create a matching folder in your project:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"my-book/\n\u2514\u2500 stages/\n   \u2514\u2500 ejs/\n      \u2514\u2500 index.js\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Inside ",(0,l.jsx)(n.code,{children:"index.js"}),", export a ",(0,l.jsx)(n.code,{children:"run()"})," function:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"// my-book/stages/ejs/index.js\nexport async function run(manuscript, { stageConfig, globalConfig }) {\n  // Your custom logic\n  // e.g., call the built-in ejs stage, then do extra stuff\n  // or replace it entirely\n  return manuscript;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Bookpub automatically detects ",(0,l.jsx)(n.code,{children:"stages/ejs/index.js"})," and uses it ",(0,l.jsx)(n.strong,{children:"instead"})," of the pre-built EJS stage."]}),"\n",(0,l.jsx)(n.h3,{id:"creating-a-new-stage",children:"Creating a New Stage"}),"\n",(0,l.jsxs)(n.p,{children:["Just name a folder in ",(0,l.jsx)(n.code,{children:"stages/"})," (e.g., ",(0,l.jsx)(n.code,{children:"stages/compressImages/"}),") with an ",(0,l.jsx)(n.code,{children:"index.js"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'// my-book/stages/compressImages/index.js\nexport async function run(manuscript, { stageConfig, globalConfig }) {\n  console.log("Compressing images...");\n  // do your stuff\n  return manuscript;\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Then add it to a pipeline in ",(0,l.jsx)(n.code,{children:"book.config.yml"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"buildPipelines:\n  pdf:\n    stages:\n      - name: ejs\n      - name: compressImages\n      - name: markdown\n      - name: theme\n"})}),"\n",(0,l.jsxs)(n.p,{children:['Here\'s an example explanation you can include in your README.md under a "Developing Custom Stages" section. This explanation details the API that each stage must follow\u2014specifically, the requirements for the exported ',(0,l.jsx)(n.code,{children:"run()"})," function and its parameters: ",(0,l.jsx)(n.code,{children:"manuscript"}),", ",(0,l.jsx)(n.code,{children:"stageConfig"}),", and ",(0,l.jsx)(n.code,{children:"globalConfig"}),"."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"developing-custom-stages",children:"Developing Custom Stages"}),"\n",(0,l.jsxs)(n.p,{children:["Bookpub's modular design allows you to extend or replace any stage by creating a new module. Each stage is expected to expose a single asynchronous function named ",(0,l.jsx)(n.code,{children:"run()"}),". When Bookpub executes a build pipeline, it will call the ",(0,l.jsx)(n.code,{children:"run()"})," function for each stage, passing in three key parameters:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsxs)(n.strong,{children:[(0,l.jsx)(n.code,{children:"run()"})," Function"]}),(0,l.jsx)(n.br,{}),"\n","This is the entry point for your stage. It must be an asynchronous function (or return a Promise) so that the build pipeline can wait for it to complete its work before proceeding to the next stage. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"export async function run(manuscript, { stageConfig, globalConfig }) {\n  // Your custom stage logic here\n  return manuscript;\n}\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsxs)(n.strong,{children:[(0,l.jsx)(n.code,{children:"manuscript"})," Object"]}),(0,l.jsx)(n.br,{}),"\n","This object represents the current state of the manuscript and is passed from one stage to the next. It typically contains:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"manuscript.content"}),": The manuscript content (e.g., rendered Markdown or HTML). Each stage can read or modify this property."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"manuscript.buildType"}),": The current build type (e.g., ",(0,l.jsx)(n.code,{children:"'html'"}),", ",(0,l.jsx)(n.code,{children:"'pdf'"}),", etc.), which might affect how the stage processes the content."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Your stage should update and then return the modified ",(0,l.jsx)(n.code,{children:"manuscript"})," so that subsequent stages can work with the latest version."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsxs)(n.strong,{children:[(0,l.jsx)(n.code,{children:"stageConfig"})," Object"]}),(0,l.jsx)(n.br,{}),"\n","This object contains configuration options specific to the current stage. It is built by merging any global defaults (from ",(0,l.jsx)(n.code,{children:"global.stages"})," in ",(0,l.jsx)(n.code,{children:"book.config.yml"}),") with pipeline-specific overrides. It is typically structured as follows:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"{\n  config: {\n    // Stage-specific configuration options go here.\n    // For example, for the built-in EJS stage:\n    rmWhitespace: true\n  },\n  meta: {\n    // Optional stage-specific metadata.\n  }\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"stageConfig.config"})," to access options for your stage. For example, if you\u2019re building a custom image compressor, you might include options such as ",(0,l.jsx)(n.code,{children:"quality"})," or ",(0,l.jsx)(n.code,{children:"maxWidth"})," in this object."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsxs)(n.strong,{children:[(0,l.jsx)(n.code,{children:"globalConfig"})," Object"]}),(0,l.jsx)(n.br,{}),"\n","This object contains configuration and metadata that apply to every stage. Typically, it includes:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'{\n  meta: {\n    // Global metadata such as title, author, publication date, etc.\n    title: "My Awesome Book",\n    author: "John Doe",\n    ...\n  }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"This allows your stage to access universal information about the book, regardless of its own specific configuration."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["By following this API, you ensure that your custom stage can be seamlessly integrated into Bookpub's build pipeline. Developers can add new functionality or override existing stages simply by creating a folder under ",(0,l.jsx)(n.code,{children:"/stages/"})," with the same name as the stage they want to replace. Bookpub will automatically use your custom implementation."]}),"\n",(0,l.jsx)(n.h2,{id:"build-outputs",children:"Build Outputs"}),"\n",(0,l.jsx)(n.p,{children:"By default, Bookpub outputs to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"build/<buildType>/\n"})}),"\n",(0,l.jsx)(n.p,{children:"For example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"build/html/\nbuild/pdf/\nbuild/pdf-lg/\n"})}),"\n",(0,l.jsx)(n.p,{children:"That folder might include:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"index.html"})," (or whatever each stage produces)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"themes/"})," (copied or compiled assets)"]}),"\n",(0,l.jsx)(n.li,{children:"Final PDF, EPUB, or other output generated by custom stages"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"pandoc-markdown-tutorial",children:"Pandoc Markdown Tutorial"}),"\n",(0,l.jsx)(n.p,{children:"This tutorial demonstrates how Pandoc converts extended Markdown into HTML. We\u2019ll cover:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"General Markdown"}),"\n",(0,l.jsx)(n.li,{children:"Fenced code blocks and attributes"}),"\n",(0,l.jsx)(n.li,{children:"Link attributes"}),"\n",(0,l.jsx)(n.li,{children:"Bracketed spans"}),"\n",(0,l.jsx)(n.li,{children:"Generic attributes"}),"\n",(0,l.jsx)(n.li,{children:"Raw attributes"}),"\n",(0,l.jsx)(n.li,{children:"How to designate specific HTML tags: section, article, footer, div, span, pre, code, br, hr"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"1-general-markdown",children:"1. General Markdown"}),"\n",(0,l.jsx)(n.p,{children:"Basic Markdown elements work as you\u2019d expect. For example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"# Sample Heading\n\nThis is a paragraph with **bold text** and *italic text*.\n\n- List item 1\n- List item 2\n"})}),"\n",(0,l.jsx)(n.p,{children:"Pandoc converts that into:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:"<h1>Sample Heading</h1>\n<p>This is a paragraph with <strong>bold text</strong> and <em>italic text</em>.</p>\n<ul>\n  <li>List item 1</li>\n  <li>List item 2</li>\n</ul>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"3-link-attributes",children:"3. Link Attributes"}),"\n",(0,l.jsx)(n.p,{children:"You can attach extra attributes to links. Check out this example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:'[Visit Google](https://google.com){: target="_blank" class="external-link"}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Pandoc converts it into:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<p><a href="https://google.com" target="_blank" class="external-link">Visit Google</a></p>\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"4-bracketed-spans",children:"4. Bracketed Spans"}),"\n",(0,l.jsx)(n.p,{children:"Bracketed spans let you add attributes to inline elements. For instance:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"This is a [highlighted text]{.highlight} within a sentence.\n"})}),"\n",(0,l.jsx)(n.p,{children:"Results in:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<p>This is a <span class="highlight">highlighted text</span> within a sentence.</p>\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"5-generic-attributes",children:"5. Generic Attributes"}),"\n",(0,l.jsx)(n.p,{children:"Generic attributes work on block-level elements like headings or paragraphs. For example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"# A Titled Section {.section-title}\n\nSome paragraph text with a generic attribute.\n"})}),"\n",(0,l.jsx)(n.p,{children:"Converts to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<h1 class="section-title">A Titled Section</h1>\n<p>Some paragraph text with a generic attribute.</p>\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"6-raw-attributes",children:"6. Raw Attributes"}),"\n",(0,l.jsx)(n.p,{children:"Raw HTML in your Markdown is passed through as-is, including its attributes. For example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:'<div data-info="raw" style="color: red;">\n  This is a raw HTML block with attributes.\n</div>\n'})}),"\n",(0,l.jsx)(n.p,{children:"Pandoc leaves it untouched:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<div data-info="raw" style="color: red;">\n  This is a raw HTML block with attributes.\n</div>\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"7-designating-specific-html-tags",children:"7. Designating Specific HTML Tags"}),"\n",(0,l.jsxs)(n.p,{children:["Pandoc\u2019s Divs (and inline spans) let you specify a custom HTML tag by using the ",(0,l.jsx)(n.code,{children:"tag"})," attribute."]}),"\n",(0,l.jsx)(n.h4,{id:"section",children:"Section"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"::: {tag=section #sec1 .intro}\nThis content is inside a <code>section</code> element.\n:::\n"})}),"\n",(0,l.jsx)(n.p,{children:"Becomes:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<section id="sec1" class="intro">\n  <p>This content is inside a <code>section</code> element.</p>\n</section>\n'})}),"\n",(0,l.jsx)(n.h4,{id:"article",children:"Article"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"::: {tag=article #article1 .post}\nContent inside an <code>article</code> element.\n:::\n"})}),"\n",(0,l.jsx)(n.p,{children:"Converts to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<article id="article1" class="post">\n  <p>Content inside an <code>article</code> element.</p>\n</article>\n'})}),"\n",(0,l.jsx)(n.h4,{id:"footer",children:"Footer"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"::: {tag=footer #footer1}\nFooter content goes here.\n:::\n"})}),"\n",(0,l.jsx)(n.p,{children:"Becomes:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<footer id="footer1">\n  <p>Footer content goes here.</p>\n</footer>\n'})}),"\n",(0,l.jsx)(n.h4,{id:"div",children:"Div"}),"\n",(0,l.jsxs)(n.p,{children:["A standard Div (without overriding the tag) remains a ",(0,l.jsx)(n.code,{children:"<div>"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"::: {#div1 .container}\nContent inside a div.\n:::\n"})}),"\n",(0,l.jsx)(n.p,{children:"Converts to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<div id="div1" class="container">\n  <p>Content inside a div.</p>\n</div>\n'})}),"\n",(0,l.jsx)(n.h4,{id:"span",children:"Span"}),"\n",(0,l.jsxs)(n.p,{children:["Bracketed spans by default yield ",(0,l.jsx)(n.code,{children:"<span>"})," elements. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"Here is an [inline span]{#span1 .highlight} in a sentence.\n"})}),"\n",(0,l.jsx)(n.p,{children:"Results in:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<p>Here is an <span id="span1" class="highlight">inline span</span> in a sentence.</p>\n'})}),"\n",(0,l.jsx)(n.h4,{id:"pre-and-code",children:"Pre and Code"}),"\n",(0,l.jsxs)(n.p,{children:["Fenced code blocks (as shown earlier) automatically produce ",(0,l.jsx)(n.code,{children:"<pre>"})," and ",(0,l.jsx)(n.code,{children:"<code>"})," blocks."]}),"\n",(0,l.jsx)(n.h4,{id:"line-break-br",children:"Line Break (br)"}),"\n",(0,l.jsx)(n.p,{children:"A hard line break can be made by ending a line with two spaces:"}),"\n",(0,l.jsx)(n.p,{children:"First line with a hard break."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"Second line continues.\n"})}),"\n",(0,l.jsx)(n.p,{children:"This converts to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:"<p>First line with a hard break.<br />\nSecond line continues.</p>\n"})}),"\n",(0,l.jsx)(n.h4,{id:"horizontal-rule-hr",children:"Horizontal Rule (hr)"}),"\n",(0,l.jsx)(n.p,{children:"A horizontal rule is simply three or more hyphens:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markdown",children:"---\n"})}),"\n",(0,l.jsx)(n.p,{children:"Which becomes:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:"<hr />\n"})}),"\n",(0,l.jsx)(n.p,{children:"This code is licensed under the C-MIT (Caffeinated-MIT) License"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(6540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);